<div class="task-form-container">
  <div class="form-header">
    <h1>{{ isEditMode ? 'Edit Task' : 'Create New Task' }}</h1>
  </div>

  <div *ngIf="loading" class="loading">Loading task...</div>

  <div *ngIf="error" class="error-message">{{ error }}</div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" *ngIf="!loading" class="task-form">
    <div class="form-group">
      <label for="title">Title <span class="required">*</span></label>
      <input
        id="title"
        type="text"
        formControlName="title"
        class="form-control"
        placeholder="Enter task title"
      />
      <div *ngIf="form.get('title')?.invalid && form.get('title')?.touched" class="error">
        <span *ngIf="form.get('title')?.errors?.['required']">Title is required</span>
        <span *ngIf="form.get('title')?.errors?.['minlength']">Title must be at least 3 characters</span>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea
        id="description"
        formControlName="description"
        class="form-control"
        placeholder="Enter task description (optional)"
        rows="5"
      ></textarea>
    </div>

    <div class="form-group">
      <label for="status">Status <span class="required">*</span></label>
      <select id="status" formControlName="status" class="form-control">
        <option *ngFor="let option of statusOptions" [value]="option">{{ option }}</option>
      </select>
      <div *ngIf="form.get('status')?.invalid && form.get('status')?.touched" class="error">
        <span *ngIf="form.get('status')?.errors?.['required']">Status is required</span>
      </div>
    </div>

    <div class="form-group">
      <label for="assignee">Assignee</label>
      <select id="assignee" formControlName="assigneeId" class="form-control">
        <option [ngValue]="null">-- Select User (optional) --</option>
        <option *ngFor="let user of users" [ngValue]="user.id">
          {{ user.name }}
        </option>
      </select>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-submit" [disabled]="form.invalid || submitting">
        {{ submitting ? 'Saving...' : (isEditMode ? 'Update Task' : 'Create Task') }}
      </button>
      <button type="button" class="btn-cancel" (click)="onCancel()">Cancel</button>
    </div>
  </form>
</div>
